

# Pillaging aka data harvesting


Pillaging is the step in which you access sensitive data and intellectual
property of the target organization

Demonstrating the feasibility of an external hacker accessing this information
might be the goal of the overall engagement, so this phase is critical


However, according to the type of machine you have compromised, you may or may 
not find what you are looking for. This presents the need to further exploit and
infiltrate the network

Therefore in this step we will also harvest data and information necessary for 
this prupose 


This encompasses getting local information such as files, enumerating
credentials, accounts, IM logs and more, but also network information such as 
internal network blocks in use, domains, intranet servers, shared hard drives, 
repositories and so on

Network information will also be used in the mapping the internal network phase


# important 

Since there is an infinite list of commands that we can run on the target
machines, we will not list all of them here. Instead, we will see the most
important and then we will give some references at the end of the section 

The important thing to remember here is that we need to get as much info as 
we can: system info, applications, services, networks, documents, messaging 
and so on 



We will see a list of scripts and commands here related to data harvesting, that 
a penetration tester could use through a meterpreter session or shell

Notice that we have already seen some of these scripts in previous phases, but
for different purposes. We will still mention them here since they are very
important for the success of this step


# Commands/Scripts 

Let us start harvesting basic information about the system 

with the "sysinfo" command, we are able to get basic information about the
remote system. Notice that the script works both on windows and linux OS's

Another command we can use is "getuid". With this command we can check the user 
that we are running as on the target machine 

Starting with this information, we can already start making assumptions about
the role of the victim machine

For example, if the previous command shows us that the victim machine is a
server, one of the most important things to check is which services are running 
on it

In other words, we have to figure out the role of the machine in the remote
network 


You should try to get answers to questions like: 

Is this a workstation? what department is it from? (R&D, Marketing, etc)

Is this a server? if so then what server (mail, web, a RADIUS, etc)


During the pillaging step, we should be able to give an accurate answer to those 
questions according to the information we get on the system

Let us start uncovering some of the commands we can run to collect more
information 



Let us first run the enum_services scripts and then check how we can get similiar
results from a shell 

meterpreter > run post/windows/gather/enum_services

As we can see, with a single command we get a list of all services on the remote
machine, the user associated with each of them, the startup type and also the 
path to the binary. The same information can be obtained on the machine, by
opening the Services config windows


It is important to know that many post exploitation scripts are implemented as 
modules and can be used outside the meterpreter session 

We just need to select the module with the "use" command, configure its options
with "set", and then excute the module with "run


As we said before, post-exploitation scripts and modules usually contain and 
execute a set of well defined operating system commands. In other words, we can
get similiar results by running the correct commands from a shell on the target 
machine

In the previous case, we can get services information with the "wmic" command


The command we are going to use is: 

# wmic service get Caption,StartName,State,pathname

Another useful command we can use to list services that re currently running is
"net start". Inspecting the results of these commands gives us a better idea of
the machine role. For example, services like DNS or IIS tell us that the
exploited machine has a server role

