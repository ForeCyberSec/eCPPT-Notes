

Objects are essentially a representation of data that is provided as a result of running
a cmdlet 

Rather than with other scripting languages where data is output as text most of the time,
PowerShell is different in that the data being output originates from classes within the 
.NET framework in the form of objects

Objects are partly compromised of collections of properties, along with methods that we can 
use to manipulate the objects



To get a list of methods for objects associated with a cmdlet we can use the Get-Member cmdlet 
as part of a pipline command, like the following

PS C:\> Get-Process | Get-Member -MemberType Method


The Get-Member cmdlet will give us an idea of all the methods for associated objects

In this case it would return output for the Get-Process objects


If we looked at the output in a PowerShell console, we could see several methods that might be of 
interest to us such as "Kill" or "start", which we could use to kill or start processes



If we wanted to use one of these on firefox for example, we can simply call the Get-Process
with the -Name parameter for the firefox process, and pipe that to the Kill method like shown below

PS C:\> Get-Process -Name "firefox" | Kill

This would kill any firefox processes


This is just one example of how we can manipulate objects using their associated methods to help us
meet our objectives




# Creating .NET Objects

In adition to using the built in cmdlets to access a large number of objects, which we can then
manipulate, we can also create .NET objects which greatly extends our capabilities using the
New-Object cmdlet

We can use the New-Object cmdlet to create an instance of a .NET Framework object or COM object

These can be either created as a "Type" of the .NET Framework class, using fully qualified names of
.NET classes, or, we can use the "ProgID" of a COM object




As an example of creating a basic object based off of a .NET class with the New-Object cmdlet, we
can use the Net.WebClient .NET system class to download a file to a target system with the code
shown in a screenshot in the folder


Explanation for the screenshot .NET code


1. We create a variable called "$webclient" which instantiates the "System.Net.WebClient" .NET
class, which is used to create a web client

2. We then create another variable ($payload_url), which is the url to our payload

3. The "$file" variable is then used as the location to which we want to save the payload on the
target system
 
4. And finally, we call the $WebClient variable with the DownloadFile method which downloads
our payload.exe to the target

