$ports=(0,22,23,80,8080);$ip="0.0.0.0"; foreach ($port in $ports) {try{$socket=New-Object System.Net.Sockets.TcpClient($ip,$port);} catch{}; if ($socket -eq $null) {Write-Output $ip":"$port" - Closed";}else{Write-Output $ip":"$port" - Open"; $socket = $null;}}