


# Powershell Shortcut Directory Path

%appdata%\Microsoft\Windows\Start Menu\Programs\Windows PowerShell


or if the shortcut is unavailable the PowerShell executable can be found in 

C:\Windows\System32\WindowsPowershell\v1.0

if other versions are available on the system, they can be found in their corresponding
version paths


# A note regarding 32-bit and 64-bit PowerShell executables

If you're operating on a 64-bit system, the location of the 64-bit PowerShell executable can be
found in

C:\windows\system32\WindowsPowerShell

While the 32-bit version being located in

C:\windows\SysWOW64\WindowsPowerShell

This can be a bit confusing considering the directory naming convention


Nonetheless, we can determine wether we're running in a 32-bit or 64-bit PowerShell environment
from the CLI with the following command

PS :C\> [Environment]::Is64BitProcess

Which should return "True" if the current PowerShell process is 64-bit



On a 32-bit system, the executable will be in its usual location of 

C:\Windows\System32\WindowsPowershell\*


we can view command line options using 

/?

or 

-help 

or 

-?

as well and will be most useful when we're calling PowerShell from a standard Windows command
prompt (cmd.exe)




# Basic Usage 

The following are some of the more common PowerShell.exe command line parameters we will use for
our purposes




# -ExecutionPolicy

The PowerShell execution policy determines which scripts if any, we can run and can easily be 
disabled with the "Bypass" or "Unrestricted" arguments


C:\> powershell.exe -ExecutePolicy Bypass .\script.ps1

and

C:\> powershell.exe -ExecutionPolicy Unrestricted .\script.ps1



# -WindowStyle

The -WindowStyle parameter hides the PowerShell window when used with the "hidden" argument

C:\> powershell.exe -WindowsStyle Hidden .\script.ps1


# -Command

The -Command parameter is used to specify a Command or Script Block to run


C:\> powershell.exe -Command Get-Process


C:\> powershell.exe -Command "& { Get-EventLog -LogName security }"



# -EncodedCommand

The -EncodedCommand parameter is used to execute base64 encoded scripts or commands

C:\> powershell.exe -EncodedCommand $encodedCommand


# -NoProfile

Dont load any PowerShell profiles

Profiles are essentially scripts that run when the powershell executable is launched and can 
interfere with our operations

C:\> powershell.exe -NoProfile .\script.ps1


# -Version

We can use the -Version parameter followed by a version number as the argument to downgrade the
version of PowerShell


This is useful in scenarios where you've landed on a machine with a more recent version and need
to downgrade to Version 1.0 or 2.0 or to complete certain tasks

Require that older versions are still installed on the target

C:\> powershell.exe -Version 2



All of the PowerShell.exe command line parameters, as well as their arguments, can also be
abbreviated, as long as the abbreviations are unique, and additionally, are not required to be
case-sensitive either. Examples shown below

# ExecutionPolicy Bypass

powershell.exe -ep Bypass
powershell.exe -ex by

# -EncodedCommand

powershell.exe -enco
powershell.exe -ec

# -WindowStyle Hidden

powershell.exe -w h
powershell.exe -wi hi



# Get-Help


An extremely useful feature of the PowerShell CLI is the Gte-Help cmdlet


//the second asterisk here is just to close the MD italics

Similiar to "*nix"* "Man Pages", we can call upon the Get-Help command to obtain information
related to any function, alias, module or cmdlet that PowerShell is aware of

We can do this by including the cmdlet, function or module name we're looking for information on,
as an argument to the "Get-Help" cmdlet


We can see here that we're requesting the PowerShell Help pages for the "Get-Help" cmdlet itelf

Get-Help Get-Help 

The above command will give us synatx and parameters for the Get-Help cmdlet




To get "full" help for any cmdlet, which includes detailed information on associated parameters,
we can use the Full parameter


PS C:\> Get-Help Get-Process -Full


Also if we'd like to get examples on how to use a specific cmdlet, we can use the -Examples
parameter


PS C:\> Get-Help Get-Process -Examples



Alternatively, if we want to get current help pages from online for any of the cmdlets or
functions, we can simply supply the -Online parameter to our command line, this will launch a
browser to the corresponding help page

PS C:\> Get-Help Get-Help -Online



If we'd like to update our locally installed help files for PowerShell via the CLI, we can do so
with the Update-Help cmdlet


PS C:\> Update-Help



# Get-Command



The Get-Command cmdlet is another useful one. It allows us to list all cmdlets, aliases,
functions, workflows, filters, scripts and any applications that are available for us to
use in PowerShell



Running the Get-Command cmdlet without arguments will simply list all commands, but we can also
use the -Name paramter to list any that are useful to us

For instance, we can list all functions related to a modification of the windows firewall
with the following command



PS C:\> Get-Command -Name *Firewall*

















